<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>å³æ™‚è®ŠåŒ–ç¤ºç¯„</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white">

<div id="app">
  <div class="flex space-x-4 p-4 bg-gray-800">
    <!-- éœæ…‹åˆ†é¡æŒ‰éˆ• -->
    <button class="px-6 py-3 text-lg rounded-full bg-white text-black font-semibold" @click="filterCategory('ä¸‰æ˜æ²»')">ä¸‰æ˜æ²»</button>
    <button class="px-6 py-3 text-lg rounded-full bg-white text-black font-semibold" @click="filterCategory('åå¸')">åå¸</button>
    <button class="px-6 py-3 text-lg rounded-full bg-white text-black font-semibold" @click="filterCategory('è²æœ')">è²æœ</button>
    <button class="px-6 py-3 text-lg rounded-full bg-white text-black font-semibold" @click="filterCategory('ç”œå“')">ç”œå“</button>
    <button class="px-6 py-3 text-lg rounded-full bg-white text-black font-semibold" @click="filterCategory('é£²å“')">é£²å“</button>
    <button class="px-6 py-3 text-lg rounded-full bg-white text-black font-semibold" @click="filterCategory('å¥—é¤')">å¥—é¤</button>
  </div>

  <div class="grid grid-cols-2 gap-4 p-4">
    <div v-for="item in filteredItems" :key="item.id" class="bg-white rounded-lg p-4 text-black flex flex-col items-center">
      <img src="https://via.placeholder.com/100" class="mb-2" />
      <div class="font-bold">{{ item.name }}</div>
      <div class="font-bold">$ {{ item.price }}</div>

      <div class="flex items-center mt-2 space-x-2">
        <button @click="decrease(item)" :disabled="item.count === 0" class="bg-gray-300 px-3 py-1 rounded-full disabled:opacity-50">
          -
        </button>
        <span class="text-xl">{{ item.count }}</span>
        <button @click="increase(item)" class="bg-gray-300 px-3 py-1 rounded-full">
          +
        </button>
      </div>
    </div>
  </div>

  <div class="fixed bottom-0 left-0 right-0 bg-white text-black flex justify-between items-center px-6 py-4 shadow-2xl text-lg">
    <div class="flex items-center">
      ğŸ›’ çµå¸³
    </div>
    <div>å·²é¸æ“‡ {{ totalCount }} é …å•†å“ãƒ»å…± {{ totalPrice }} å…ƒ</div>
  </div>
</div>

<script>
const { createApp } = Vue;

createApp({
  data() {
    return {
      items: [], // ç”¨ä¾†å­˜å„²å¾ API ç²å–çš„å•†å“è³‡æ–™
      category: 'ä¸‰æ˜æ²»', // é»˜èªåˆ†é¡
    };
  },
  computed: {
    filteredItems() {
      console.log("ç›®å‰çš„åˆ†é¡ï¼š", this.category); // ç”¨æ–¼èª¿è©¦
      return this.items.filter(item => item.category === this.category);
    },
    totalCount() {
      return this.items.reduce((sum, item) => sum + item.count, 0);
    },
    totalPrice() {
      return this.items.reduce((sum, item) => sum + item.count * parseFloat(item.price), 0);
    }
  },
  methods: {
    async fetchMenuItems() {
      try {
        const response = await axios.get('http://127.0.0.1:8000/api/menu/');
        console.log('ç²å–çš„å•†å“è³‡æ–™ï¼š', response.data); // ç”¨æ–¼èª¿è©¦
        // ç‚ºæ¯å€‹å•†å“æ·»åŠ  count å±¬æ€§
        this.items = response.data.map(item => ({
          ...item,
          count: 0
        }));
      } catch (error) {
        console.error('Error fetching menu items:', error);
      }
    },
    increase(item) {
      item.count++;
    },
    decrease(item) {
      if (item.count > 0) item.count--;
    },
    filterCategory(category) {
      console.log("åˆ‡æ›åˆ†é¡ç‚ºï¼š", category); // ç”¨æ–¼èª¿è©¦
      this.category = category; // æ›´æ–°ç•¶å‰åˆ†é¡
    }
  },
  mounted() {
    this.fetchMenuItems(); // é é¢åŠ è¼‰å¾Œï¼Œç²å–å•†å“è³‡æ–™
  }
}).mount('#app');
</script>

</body>
</html>
